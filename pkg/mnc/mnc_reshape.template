C $Header: /home/jahn/src/cvs2git/MITgcm/20170915-2/gcmpack-all-patch/MITgcm/pkg/mnc/Attic/mnc_reshape.template,v 1.3 2004/01/18 23:23:15 edhill Exp $
C $Name:  $

#include "MNC_OPTIONS.h"

      SUBROUTINE MNC_RESHAPE_RX_YY( ni,nj,nk, istart,iend, din,dout ) 

      implicit none

C     Arguments
      integer ni,nj,nk, istart(3), iend(3)
      _RX din(ni,nj,nk)
#define mnc_rtype_YY
#ifdef  mnc_rtype_D
      REAL*8 dout(*)
#endif
#ifdef  mnc_rtype_R
      REAL*4 dout(*)
#endif
#undef mnc_rtype_YY

C     Locals
      integer i,j,k, n
      
      n = 0
      IF (nk .GT. 1) THEN
C        print *, ni,nj,nk, 
C     &       '   istart = ', istart(1), ',', istart(2), ',', istart(3),
C     &       '   iend   = ', iend(1), ',', iend(2), ',', iend(3)
        DO k = istart(3),iend(3)
          DO j = istart(2),iend(2)
            DO i = istart(1),iend(1)
              n = n + 1
              dout(n) = din(i,j,k)
            ENDDO
          ENDDO
        ENDDO
      ELSEIF (nj .GT. 1) THEN
C        print *, ni,nj, 
C     &       '   istart = ', istart(1), ',', istart(2),
C     &       '   iend   = ', iend(1), ',', iend(2)
        k = 1
        DO j = istart(2),iend(2)
          DO i = istart(1),iend(1)
            n = n + 1
            dout(n) = din(i,j,k)
          ENDDO
        ENDDO
      ELSE
C        print *, ni,
C     &       '   istart = ', istart(1), 
C     &       '   iend   = ', iend(1)
        k = 1
        j = 1
        DO i = istart(1),iend(1)
          n = n + 1
          dout(n) = din(i,j,k)
        ENDDO
      ENDIF

      RETURN
      END

CEH3 ;;; Local Variables: ***
CEH3 ;;; mode:fortran ***
CEH3 ;;; End: ***
